webpackJsonp([14,25],{B5Td:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xftn"),r={props:{value:{type:Boolean,default:!1},modelForm:{type:Object},appList:{type:Array}},data:function(){return{data:[],nameSpaceList:[],filters:{AppId:null},show:!1,btnName:"新建",rules:{Environment:[{required:!0,message:"环境数据丢失",trigger:"blur"}],ConfigKey:[{required:!0,message:"请输入配置项",trigger:"blur"}],ConfigValue:[{required:!0,message:"请输入配置值",trigger:"blur"}],ConfigAppId:[{required:!0,message:"请选择项目组",trigger:"blur"}],ConfigNamespaceName:[{required:!0,message:"请选择项目",trigger:"blur"}]}}},created:function(){this.BLL=new a.a(this),this.value&&(this.show=!0)},computed:{loading:function(){return this.$store.getters.btnLoading.str&&"edit"===this.$store.getters.btnLoading.id}},mounted:function(){},methods:{handleReset:function(){this.$refs.modelForm.resetFields()},handleSubmit:function(e){this.BLL.editSubmit(e)},searchNamespace:function(){this.filters.AppId=this.modelForm.ConfigAppId,this.BLL.searchProejct()}},watch:{show:function(e){var t=this;this.$emit("input",e),e?this.$nextTick(function(){t.data=[],t.modelForm.Id?t.btnName="编辑":t.btnName="新建"}):(this.$refs.modelForm.clearValidate(),this.nameSpaceList=[])},value:function(e){this.show=e}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.btnName,visible:e.show,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.show=t}}},[e.modelForm?n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modelForm",attrs:{model:e.modelForm,rules:e.rules,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"环境",prop:"Environment"}},[e._v("\n      "+e._s(e.modelForm.Environment)+"\n    ")]),e._v(" "),n("el-form-item",{attrs:{label:"归属项目组",prop:"ConfigAppId"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.searchNamespace()}},model:{value:e.modelForm.ConfigAppId,callback:function(t){e.$set(e.modelForm,"ConfigAppId",t)},expression:"modelForm.ConfigAppId"}},e._l(e.appList,function(e){return n("el-option",{key:e.AppId,attrs:{label:e.Name,value:e.AppId}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"归属项目",prop:"ConfigNamespaceName"}},[n("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.modelForm.ConfigNamespaceName,callback:function(t){e.$set(e.modelForm,"ConfigNamespaceName",t)},expression:"modelForm.ConfigNamespaceName"}},e._l(e.nameSpaceList,function(e){return n("el-option",{key:e.Name,attrs:{label:e.Name,value:e.Name}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"配置Key",prop:"ConfigKey"}},[n("el-input",{model:{value:e.modelForm.ConfigKey,callback:function(t){e.$set(e.modelForm,"ConfigKey",t)},expression:"modelForm.ConfigKey"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"配置Value",prop:"ConfigValue"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.modelForm.ConfigValue,callback:function(t){e.$set(e.modelForm,"ConfigValue",t)},expression:"modelForm.ConfigValue"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"Comment"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.modelForm.Remark,callback:function(t){e.$set(e.modelForm,"Remark",t)},expression:"modelForm.Remark"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否删除",prop:"IsDeleted"}},[n("el-switch",{model:{value:e.modelForm.IsDeleted,callback:function(t){e.$set(e.modelForm,"IsDeleted",t)},expression:"modelForm.IsDeleted"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.btnName))]),e._v(" "),n("el-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1):e._e()],1)},staticRenderFns:[]};var o=n("VU/8")(r,i,!1,function(e){n("YBF3")},null,null);t.default=o.exports},HVfW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Dd8w"),r=n.n(a),i=n("QEUx"),o=n("B5Td"),l=n("Xftn"),s={components:{iTable:i.a,Edit:o.default},data:function(){var e=this;return{editModel:null,showEdit:!1,appList:[],nameSpaceList:[],filters:{AppId:null,NameSpace:null,Environment:"dev"},currentIndex:1,pagination:{size:10},dataList:[],columns:[{prop:"Id",label:"编号",width:80,align:"center"},{prop:"ConfigAppId",label:"AppId",width:100},{prop:"ConfigNamespaceName",label:"项目",width:120},{prop:"ConfigKey",label:"Key",width:150},{prop:"ConfigValue",label:"Value"},{prop:"Remark",label:"备注",width:180},{prop:"Version",label:"版本号",align:"center",width:80},{prop:"LastTime",label:"修改时间",width:160},{prop:"IsDeleted",label:"删除",align:"center",width:80,render:function(e,t){return e.IsDeleted?"是":"否"}}],operateColumn:{width:110,fixed:"right",list:[{type:"primary",name:"编辑",icon:"edit",method:function(t,n){e.editModel=r()({},n,{Environment:e.filters.Environment}),e.showEdit=!0},disabled:function(e,t){}}]}}},computed:{loading:function(){return this.$store.getters.btnLoading.str&&!this.$store.getters.btnLoading.id}},created:function(){this.BLL=new l.a(this),this.BLL.init(),this.BLL.search()},beforeDestroy:function(){},mounted:function(){},methods:{handleTableChange:function(e){this.BLL.handleTableChange(e)}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("el-form",{attrs:{inline:!0,model:e.filters}},[n("el-form-item",[n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.BLL.searchProejct()}},model:{value:e.filters.AppId,callback:function(t){e.$set(e.filters,"AppId",t)},expression:"filters.AppId"}},e._l(e.appList,function(e){return n("el-option",{key:e.AppId,attrs:{label:e.Name,value:e.AppId}})}))],1),e._v(" "),n("el-form-item",[n("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.filters.NameSpace,callback:function(t){e.$set(e.filters,"NameSpace",t)},expression:"filters.NameSpace"}},[n("el-option",{key:"AppId",attrs:{label:"全部项目",value:""}}),e._v(" "),e._l(e.nameSpaceList,function(e){return n("el-option",{key:e.Name,attrs:{label:e.Name,value:e.Name}})})],2)],1),e._v(" "),n("el-form-item",{attrs:{label:"环境"}},[n("el-select",{on:{change:function(t){e.BLL.search()}},model:{value:e.filters.Environment,callback:function(t){e.$set(e.filters,"Environment",t)},expression:"filters.Environment"}},[n("el-option",{attrs:{label:"测试环境",value:"dev"}}),e._v(" "),n("el-option",{attrs:{label:"测试验收环境",value:"uat"}}),e._v(" "),n("el-option",{attrs:{label:"预生产环境",value:"prepro"}}),e._v(" "),n("el-option",{attrs:{label:"生产环境",value:"pro"}})],1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.BLL.search()}}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.BLL.add()}}},[e._v("新增")])],1)],1),e._v(" "),n("iTable",{ref:"iTable",attrs:{tableData:e.dataList,columns:e.columns,loading:e.loading,operateColumn:e.operateColumn,pagination:e.pagination,otherHeight:230},on:{handleTableChange:e.handleTableChange}}),e._v(" "),n("edit",{attrs:{modelForm:e.editModel,appList:e.appList},on:{addSuccess:function(t){e.BLL.search()}},model:{value:e.showEdit,callback:function(t){e.showEdit=t},expression:"showEdit"}})],1)},staticRenderFns:[]},c=n("VU/8")(s,u,!1,null,null,null);t.default=c.exports},Xftn:function(e,t,n){"use strict";var a=n("Dd8w"),r=n.n(a),i=n("Xxa5"),o=n.n(i),l=n("exGp"),s=n.n(l),u=n("Zx67"),c=n.n(u),m=n("Zrlr"),p=n.n(m),d=n("wxAW"),f=n.n(d),h=n("zwoO"),v=n.n(h),g=n("Pf15"),b=n.n(g),L=n("cLwg"),y=function(e){function t(){return p()(this,t),v()(this,(t.__proto__||c()(t)).apply(this,arguments))}return b()(t,e),f()(t,[{key:"init",value:function(){var e=s()(o.a.mark(function e(){var t,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.QueryAppList();case 2:(t=e.sent)&&t.Data.forEach(function(e){n.vm.appList.push({AppId:e.AppId,Name:e.Name})});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"searchProejct",value:function(){var e=s()(o.a.mark(function e(){var t,n,a=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vm.filters,e.next=3,L.a.QueryProjectList(t,{load:!1});case 3:(n=e.sent)&&(this.vm.nameSpaceList=[],n.Data.forEach(function(e){a.vm.nameSpaceList.push({Id:e.Id,Name:e.Name})}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetch",value:function(){var e=s()(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.QueryConfigList(t);case 2:(n=e.sent)&&(this.vm.dataList=n.Data,this.vm.pagination.total=n.Total);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vm.currentIndex=1,this.fetch(r()({PageIndex:this.vm.currentIndex,PageSize:this.vm.pagination.size},this.vm.filters));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleTableChange",value:function(e){this.vm.currentIndex=e.current,this.fetch(r()({PageIndex:e.current,PageSize:e.pageSize},this.vm.filters))}},{key:"add",value:function(){this.vm.editModel={ConfigAppId:null,ConfigNamespaceName:null,ConfigKey:null,ConfigValue:null,Remark:null,IsDeleted:!1,Environment:this.vm.filters.Environment},this.vm.showEdit=!0}},{key:"editSubmit",value:function(){var e,t=this;this.vm.$refs.modelForm.validate((e=s()(o.a.mark(function e(n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return a={loadID:"edit"},e.next=4,L.a.SetConfigInfo(t.vm.modelForm,a);case 4:e.sent&&(t.vm.show=!1,t.vm.$emit("addSuccess"),t.vm.$notify({title:"成功",message:"操作成功",type:"success"})),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}]),t}(n("ARvU").a);t.a=y},YBF3:function(e,t){}});