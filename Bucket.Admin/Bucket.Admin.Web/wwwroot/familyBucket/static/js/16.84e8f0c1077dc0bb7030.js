webpackJsonp([16,31],{Jlac:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={props:{value:{type:Boolean,default:!1},modelForm:{type:Object}},data:function(){return{data:[],show:!1}},created:function(){this.value&&(this.show=!0)},computed:{loading:function(){return this.$store.getters.btnLoading.str&&"edit"===this.$store.getters.btnLoading.id}},mounted:function(){},methods:{},watch:{show:function(e){this.$emit("input",e)},value:function(e){this.show=e}}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"片段详细内容",visible:e.show,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(t){e.show=t}}},[e.modelForm?n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.modelForm,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"JSON内容",prop:"JSON"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:17,maxRows:30}},model:{value:e.modelForm.JSON,callback:function(t){e.$set(e.modelForm,"JSON",t)},expression:"modelForm.JSON"}})],1)],1):e._e()],1)},staticRenderFns:[]};var r=n("VU/8")(s,a,!1,function(e){n("wYCY")},null,null);t.default=r.exports},uFq1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("mvHQ"),a=n.n(s),r=n("Xxa5"),i=n.n(r),o=n("exGp"),l=n.n(o),c=n("Zx67"),u=n.n(c),d=n("Zrlr"),m=n.n(d),f=n("wxAW"),p=n.n(f),v=n("zwoO"),b=n.n(v),h=n("Pf15"),w=n.n(h),k=n("ARvU"),L=n("f485"),g=void 0,y=[],_=function(e){function t(){return m()(this,t),b()(this,(t.__proto__||u()(t)).apply(this,arguments))}return w()(t,e),p()(t,[{key:"initWebSocket",value:function(){var e=this;(g=new WebSocket("ws://10.10.188.136:17071/skrTrace?"+window.$globalHub.$store.state.auth.authInfo.Id)).onopen=function(t){console.log("Connection open ..."),e.vm.$message({message:"WebSocket连接已建立，正在等待数据...",type:"success"}),e.vm.initWebSocketBtnDisabled=!0,e.vm.closeWebSocketBtnDisabled=!1,e.vm.addListenerBtnDisabled=!1,e.vm.ListenerInputBtnDisabled=!1},g.onmessage=function(t){var n=JSON.parse(t.data);console.log("Received Message: ",n.MessageType,n.Data),0===n.MessageType&&(console.log(y.length),y.push(JSON.parse(n.Data)),e.vm.dataList=y.sort(function(e,t){return e.StartTime-t.StartTime}))},g.onclose=function(t){console.log("Connection closed."),e.vm.$message({message:"WebSocket和服务器断开连接...",type:"success"}),e.vm.initWebSocketBtnDisabled=!1,e.vm.closeWebSocketBtnDisabled=!0,e.vm.addListenerBtnDisabled=!0,e.vm.removeListenerDisabled=!0,e.vm.ListenerInputBtnDisabled=!0}}},{key:"closeWebSocket",value:function(){g&&g.close()}},{key:"addListener",value:function(){var e=l()(i.a.mark(function e(){var t=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vm.$refs.filters.validate(function(){var e=l()(i.a.mark(function e(n){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return s="?groupId="+t.vm.filters.Identity+"&socketId="+window.$globalHub.$store.state.auth.authInfo.Id,e.next=4,L.a.AddListener(s);case 4:e.sent&&(t.vm.$message({message:"信息监听建立成功",type:"success"}),t.vm.addListenerBtnDisabled=!0,t.vm.removeListenerDisabled=!1,t.vm.ListenerInputBtnDisabled=!0),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeListener",value:function(){var e=l()(i.a.mark(function e(){var t=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vm.$refs.filters.validate(function(){var e=l()(i.a.mark(function e(n){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return s="?groupId="+t.vm.filters.Identity+"&socketId="+window.$globalHub.$store.state.auth.authInfo.Id,e.next=4,L.a.RemoveListener(s);case 4:e.sent&&(t.vm.$message({message:"信息监听取消成功",type:"success"}),t.vm.addListenerBtnDisabled=!1,t.vm.removeListenerDisabled=!0,t.vm.ListenerInputBtnDisabled=!1,t.vm.filters.Identity=null),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clear",value:function(){var e=l()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vm.dataList=[],y=[];case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(k.a),S={components:{TraceOnlineShow:n("Jlac").default},data:function(){return{initWebSocketBtnDisabled:!1,closeWebSocketBtnDisabled:!0,addListenerBtnDisabled:!0,removeListenerDisabled:!0,ListenerInputBtnDisabled:!0,viewModel:null,showView:!1,filters:{Identity:null},dataList:[],rules:{Identity:[{required:!0,message:"请填写监听标识",trigger:"blur"}]}}},computed:{loading:function(){return this.$store.getters.btnLoading.str&&!this.$store.getters.btnLoading.id}},created:function(){this.BLL=new _(this)},beforeDestroy:function(){this.BLL.closeWebSocket()},mounted:function(){},methods:{handleClick:function(e){console.log(e),this.viewModel={JSON:a()(e,null,4)},this.showView=!0}}},D={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("el-form",{ref:"filters",attrs:{model:e.filters,rules:e.rules,inline:!0},model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}},[n("el-form-item",[n("el-button",{attrs:{type:"primary",disabled:e.initWebSocketBtnDisabled},on:{click:function(t){e.BLL.initWebSocket()}}},[e._v("连接")]),e._v(" "),n("el-button",{attrs:{type:"danger",disabled:e.closeWebSocketBtnDisabled},on:{click:function(t){e.BLL.closeWebSocket()}}},[e._v("断开")])],1),e._v(" "),n("el-form-item",{attrs:{prop:"Identity"}},[n("el-input",{attrs:{placeholder:"监听标识",disabled:e.ListenerInputBtnDisabled},model:{value:e.filters.Identity,callback:function(t){e.$set(e.filters,"Identity",t)},expression:"filters.Identity"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",disabled:e.addListenerBtnDisabled},on:{click:function(t){e.BLL.addListener()}}},[e._v("开始监听")]),e._v(" "),n("el-button",{attrs:{type:"danger",disabled:e.removeListenerDisabled},on:{click:function(t){e.BLL.removeListener()}}},[e._v("移除监听")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.BLL.clear()}}},[e._v("清屏")])],1)],1),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:""}},[n("el-table-column",{attrs:{prop:"ApplicationCode",label:"应用"}}),e._v(" "),n("el-table-column",{attrs:{prop:"OperationName",label:"模块"}}),e._v(" "),n("el-table-column",{attrs:{prop:"SpanLayer",label:"类型"}}),e._v(" "),n("el-table-column",{attrs:{prop:"Component",label:"组件"}}),e._v(" "),n("el-table-column",{attrs:{prop:"Duration",label:"耗时"}}),e._v(" "),n("el-table-column",{attrs:{prop:"Time",label:"时间"}}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.handleClick(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),n("traceOnlineShow",{attrs:{modelForm:e.viewModel},model:{value:e.showView,callback:function(t){e.showView=t},expression:"showView"}})],1)},staticRenderFns:[]},B=n("VU/8")(S,D,!1,null,null,null);t.default=B.exports},wYCY:function(e,t){}});